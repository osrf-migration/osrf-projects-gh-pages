{"links": {"self": {"href": "data/repositories/osrf/robocup3ds/pullrequests/8/comments/8566066.json"}, "html": {"href": "#!/osrf/robocup3ds/pull-requests/8/_/diff#comment-8566066"}}, "parent": {"id": 8564745, "links": {"self": {"href": "data/repositories/osrf/robocup3ds/pullrequests/8/comments/8564745.json"}, "html": {"href": "#!/osrf/robocup3ds/pull-requests/8/_/diff#comment-8564745"}}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 8, "links": {"self": {"href": "data/repositories/osrf/robocup3ds/pullrequests/8.json"}, "html": {"href": "#!/osrf/robocup3ds/pull-requests/8"}}, "title": "Nima_actionparser"}, "content": {"raw": "Hey Nima,\n\nWith the current version of the plugin, it would be very difficult to call update() in parse() because update() accesses certain member variables in Agent and parse() is run by the server thread. It would mean that we have to use a mutex everytime the Agent object is accessed by both the gamestate thread and server thread, otherwise it would not be thread safe. I prefer the current version, where the only data structure shared between threads is effector.socketIDMessageMap. \n\nAs for the message overwriting problem, we can change it so that messages appended to socketIDMessageMap everytime parse() is called. ", "markup": "markdown", "html": "<p>Hey Nima,</p>\n<p>With the current version of the plugin, it would be very difficult to call update() in parse() because update() accesses certain member variables in Agent and parse() is run by the server thread. It would mean that we have to use a mutex everytime the Agent object is accessed by both the gamestate thread and server thread, otherwise it would not be thread safe. I prefer the current version, where the only data structure shared between threads is effector.socketIDMessageMap. </p>\n<p>As for the message overwriting problem, we can change it so that messages appended to socketIDMessageMap everytime parse() is called. </p>", "type": "rendered"}, "created_on": "2015-07-27T20:40:40.770764+00:00", "user": {"display_name": "jasonzliang NA", "uuid": "{663c75f1-dde2-425c-aa25-68ad2f4eb5ec}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B663c75f1-dde2-425c-aa25-68ad2f4eb5ec%7D"}, "html": {"href": "https://bitbucket.org/%7B663c75f1-dde2-425c-aa25-68ad2f4eb5ec%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:4f6d7230-9817-448e-8b0d-98cb3dd0821c/5b9c099e-6241-49a1-ba1d-fabcca24c6c3/128"}}, "nickname": "jasonzliang", "type": "user", "account_id": "557058:4f6d7230-9817-448e-8b0d-98cb3dd0821c"}, "updated_on": "2015-07-27T20:40:40.779727+00:00", "type": "pullrequest_comment", "id": 8566066}