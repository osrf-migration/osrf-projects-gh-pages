{"links": {"self": {"href": "data/repositories/osrf/robocup3ds/pullrequests/19/comments/9148716.json"}, "html": {"href": "#!/osrf/robocup3ds/pull-requests/19/_/diff#comment-9148716"}}, "deleted": false, "pullrequest": {"type": "pullrequest", "id": 19, "links": {"self": {"href": "data/repositories/osrf/robocup3ds/pullrequests/19.json"}, "html": {"href": "#!/osrf/robocup3ds/pull-requests/19"}}, "title": "Modeling of simspark NAO robot and its Controller "}, "content": {"raw": "In order to link I had to remove some of the hardcoded libraries in src/CMakeLists.txt (libgazebo_physics_dart.so, libgazebo_physics_simbody.so, and libgazebo_player.so). We shouldn't have these libraries hardcoded, it will be difficult to maintain. We should use cmake and GAZEBO_LIBRARIES.\n\nWhen running, I see a segfault. This is the backtrace:\n\n```\n#!c++\n\nProgram received signal SIGABRT, Aborted.\n[Switching to Thread 0x7fff90bf3700 (LWP 30995)]\n0x00007ffff688d267 in __GI_raise (sig=sig@entry=6)\n    at ../sysdeps/unix/sysv/linux/raise.c:55\n55\t../sysdeps/unix/sysv/linux/raise.c: No such file or directory.\n(gdb) bt\n#0  0x00007ffff688d267 in __GI_raise (sig=sig@entry=6)\n    at ../sysdeps/unix/sysv/linux/raise.c:55\n#1  0x00007ffff688eeca in __GI_abort () at abort.c:89\n#2  0x00007ffff688603d in __assert_fail_base (\n    fmt=0x7ffff69e8028 \"%s%s%s:%u: %s%sAssertion `%s' failed.\\n%n\", \n    assertion=assertion@entry=0x7fffac0a4828 \"px != 0\", \n    file=file@entry=0x7fffac0a4a30 \"/usr/include/boost/smart_ptr/shared_ptr.hpp\", line=line@entry=653, \n    function=function@entry=0x7fffac0a6ac0 <boost::shared_ptr<gazebo::physics::Model>::operator->() const::__PRETTY_FUNCTION__> \"typename boost::detail::sp_member_access<T>::type boost::shared_ptr<T>::operator->() const [with T = gazebo::physics::Model; typename boost::detail::sp_member_access<T>::type = gazebo::physics::Model*\"...) at assert.c:92\n#3  0x00007ffff68860f2 in __GI___assert_fail (\n    assertion=0x7fffac0a4828 \"px != 0\", \n    file=0x7fffac0a4a30 \"/usr/include/boost/smart_ptr/shared_ptr.hpp\", \n    line=653, \n    function=0x7fffac0a6ac0 <boost::shared_ptr<gazebo::physics::Model>::operator->() const::__PRETTY_FUNCTION__> \"typename boost::detail::sp_member_access<T>::type boost::shared_ptr<T>::operator->() const [with T = gazebo::physics::Model; typename boost::detail::sp_member_access<T>::type = gazebo::physics::Model*\"...)\n    at assert.c:101\n#4  0x00007fffac08e993 in boost::shared_ptr<gazebo::physics::Model>::operator->\n    (this=<optimized out>) at /usr/include/boost/smart_ptr/shared_ptr.hpp:653\n#5  0x00007fffac093276 in operator-> (this=<optimized out>)\n    at /home/caguero/workspace/robocup3ds/src/Robocup3dsPlugin.cc:459\n#6  Robocup3dsPlugin::UpdateGameState (this=this@entry=0x7fff4401e9d0)\n    at /home/caguero/workspace/robocup3ds/src/Robocup3dsPlugin.cc:451\n#7  0x00007fffac093450 in Robocup3dsPlugin::Update (this=0x7fff4401e9d0)\n    at /home/caguero/workspace/robocup3ds/src/Robocup3dsPlugin.cc:176\n#8  0x00007ffff62e6c81 in operator() (a0=..., this=<optimized out>)\n    at /usr/include/boost/function/function_template.hpp:767\n#9  Signal<gazebo::common::UpdateInfo> (_p=..., this=<optimized out>)\n    at /home/caguero/workspace/gazebo/gazebo/common/Event.hh:377\n#10 operator()<gazebo::common::UpdateInfo> (_p=..., this=<optimized out>)\n    at /home/caguero/workspace/gazebo/gazebo/common/Event.hh:213\n#11 gazebo::physics::World::Update (this=this@entry=0x1674840)\n    at /home/caguero/workspace/gazebo/gazebo/physics/World.cc:766\n#12 0x00007ffff62f313f in gazebo::physics::World::Step (\n    this=this@entry=0x1674840)\n    at /home/caguero/workspace/gazebo/gazebo/physics/World.cc:698\n#13 0x00007ffff62f3605 in gazebo::physics::World::RunLoop (this=0x1674840)\n    at /home/caguero/workspace/gazebo/gazebo/physics/World.cc:467\n#14 0x00007ffff498309a in ?? ()\n   from /usr/lib/x86_64-linux-gnu/libboost_thread.so.1.55.0\n#15 0x00007ffff55f06aa in start_thread (arg=0x7fff90bf3700)\n    at pthread_create.c:333\n#16 0x00007ffff695eeed in clone ()\n    at ../sysdeps/unix/sysv/linux/x86_64/clone.S:109\n```\n\nIt seems is related with the ball name. Do I need to update something?", "markup": "markdown", "html": "<p>In order to link I had to remove some of the hardcoded libraries in src/CMakeLists.txt (libgazebo_physics_dart.so, libgazebo_physics_simbody.so, and libgazebo_player.so). We shouldn't have these libraries hardcoded, it will be difficult to maintain. We should use cmake and GAZEBO_LIBRARIES.</p>\n<p>When running, I see a segfault. This is the backtrace:</p>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"n\">Program</span> <span class=\"n\">received</span> <span class=\"n\">signal</span> <span class=\"n\">SIGABRT</span><span class=\"p\">,</span> <span class=\"n\">Aborted</span><span class=\"p\">.</span>\n<span class=\"p\">[</span><span class=\"n\">Switching</span> <span class=\"n\">to</span> <span class=\"n\">Thread</span> <span class=\"mh\">0x7fff90bf3700</span> <span class=\"p\">(</span><span class=\"n\">LWP</span> <span class=\"mi\">30995</span><span class=\"p\">)]</span>\n<span class=\"mh\">0x00007ffff688d267</span> <span class=\"n\">in</span> <span class=\"n\">__GI_raise</span> <span class=\"p\">(</span><span class=\"n\">sig</span><span class=\"o\">=</span><span class=\"n\">sig</span><span class=\"err\">@</span><span class=\"n\">entry</span><span class=\"o\">=</span><span class=\"mi\">6</span><span class=\"p\">)</span>\n    <span class=\"n\">at</span> <span class=\"p\">..</span><span class=\"o\">/</span><span class=\"n\">sysdeps</span><span class=\"o\">/</span><span class=\"n\">unix</span><span class=\"o\">/</span><span class=\"n\">sysv</span><span class=\"o\">/</span><span class=\"n\">linux</span><span class=\"o\">/</span><span class=\"n\">raise</span><span class=\"p\">.</span><span class=\"nl\">c</span><span class=\"p\">:</span><span class=\"mi\">55</span>\n<span class=\"mi\">55</span>  <span class=\"p\">..</span><span class=\"o\">/</span><span class=\"n\">sysdeps</span><span class=\"o\">/</span><span class=\"n\">unix</span><span class=\"o\">/</span><span class=\"n\">sysv</span><span class=\"o\">/</span><span class=\"n\">linux</span><span class=\"o\">/</span><span class=\"n\">raise</span><span class=\"p\">.</span><span class=\"nl\">c</span><span class=\"p\">:</span> <span class=\"n\">No</span> <span class=\"n\">such</span> <span class=\"n\">file</span> <span class=\"n\">or</span> <span class=\"n\">directory</span><span class=\"p\">.</span>\n<span class=\"p\">(</span><span class=\"n\">gdb</span><span class=\"p\">)</span> <span class=\"n\">bt</span>\n<span class=\"cp\">#0  0x00007ffff688d267 in __GI_raise (sig=sig@entry=6)</span>\n    <span class=\"n\">at</span> <span class=\"p\">..</span><span class=\"o\">/</span><span class=\"n\">sysdeps</span><span class=\"o\">/</span><span class=\"n\">unix</span><span class=\"o\">/</span><span class=\"n\">sysv</span><span class=\"o\">/</span><span class=\"n\">linux</span><span class=\"o\">/</span><span class=\"n\">raise</span><span class=\"p\">.</span><span class=\"nl\">c</span><span class=\"p\">:</span><span class=\"mi\">55</span>\n<span class=\"cp\">#1  0x00007ffff688eeca in __GI_abort () at abort.c:89</span>\n<span class=\"cp\">#2  0x00007ffff688603d in __assert_fail_base (</span>\n    <span class=\"n\">fmt</span><span class=\"o\">=</span><span class=\"mh\">0x7ffff69e8028</span> <span class=\"s\">&quot;%s%s%s:%u: %s%sAssertion `%s&#39; failed.</span><span class=\"se\">\\n</span><span class=\"s\">%n&quot;</span><span class=\"p\">,</span> \n    <span class=\"n\">assertion</span><span class=\"o\">=</span><span class=\"n\">assertion</span><span class=\"err\">@</span><span class=\"n\">entry</span><span class=\"o\">=</span><span class=\"mh\">0x7fffac0a4828</span> <span class=\"s\">&quot;px != 0&quot;</span><span class=\"p\">,</span> \n    <span class=\"n\">file</span><span class=\"o\">=</span><span class=\"n\">file</span><span class=\"err\">@</span><span class=\"n\">entry</span><span class=\"o\">=</span><span class=\"mh\">0x7fffac0a4a30</span> <span class=\"s\">&quot;/usr/include/boost/smart_ptr/shared_ptr.hpp&quot;</span><span class=\"p\">,</span> <span class=\"n\">line</span><span class=\"o\">=</span><span class=\"n\">line</span><span class=\"err\">@</span><span class=\"n\">entry</span><span class=\"o\">=</span><span class=\"mi\">653</span><span class=\"p\">,</span> \n    <span class=\"n\">function</span><span class=\"o\">=</span><span class=\"n\">function</span><span class=\"err\">@</span><span class=\"n\">entry</span><span class=\"o\">=</span><span class=\"mh\">0x7fffac0a6ac0</span> <span class=\"o\">&lt;</span><span class=\"n\">boost</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">physics</span><span class=\"o\">::</span><span class=\"n\">Model</span><span class=\"o\">&gt;::</span><span class=\"k\">operator</span><span class=\"o\">-&gt;</span><span class=\"p\">()</span> <span class=\"k\">const</span><span class=\"o\">::</span><span class=\"n\">__PRETTY_FUNCTION__</span><span class=\"o\">&gt;</span> <span class=\"s\">&quot;typename boost::detail::sp_member_access&lt;T&gt;::type boost::shared_ptr&lt;T&gt;::operator-&gt;() const [with T = gazebo::physics::Model; typename boost::detail::sp_member_access&lt;T&gt;::type = gazebo::physics::Model*&quot;</span><span class=\"p\">...)</span> <span class=\"n\">at</span> <span class=\"n\">assert</span><span class=\"p\">.</span><span class=\"nl\">c</span><span class=\"p\">:</span><span class=\"mi\">92</span>\n<span class=\"cp\">#3  0x00007ffff68860f2 in __GI___assert_fail (</span>\n    <span class=\"n\">assertion</span><span class=\"o\">=</span><span class=\"mh\">0x7fffac0a4828</span> <span class=\"s\">&quot;px != 0&quot;</span><span class=\"p\">,</span> \n    <span class=\"n\">file</span><span class=\"o\">=</span><span class=\"mh\">0x7fffac0a4a30</span> <span class=\"s\">&quot;/usr/include/boost/smart_ptr/shared_ptr.hpp&quot;</span><span class=\"p\">,</span> \n    <span class=\"n\">line</span><span class=\"o\">=</span><span class=\"mi\">653</span><span class=\"p\">,</span> \n    <span class=\"n\">function</span><span class=\"o\">=</span><span class=\"mh\">0x7fffac0a6ac0</span> <span class=\"o\">&lt;</span><span class=\"n\">boost</span><span class=\"o\">::</span><span class=\"n\">shared_ptr</span><span class=\"o\">&lt;</span><span class=\"n\">gazebo</span><span class=\"o\">::</span><span class=\"n\">physics</span><span class=\"o\">::</span><span class=\"n\">Model</span><span class=\"o\">&gt;::</span><span class=\"k\">operator</span><span class=\"o\">-&gt;</span><span class=\"p\">()</span> <span class=\"k\">const</span><span class=\"o\">::</span><span class=\"n\">__PRETTY_FUNCTION__</span><span class=\"o\">&gt;</span> <span class=\"s\">&quot;typename boost::detail::sp_member_access&lt;T&gt;::type boost::shared_ptr&lt;T&gt;::operator-&gt;() const [with T = gazebo::physics::Model; typename boost::detail::sp_member_access&lt;T&gt;::type = gazebo::physics::Model*&quot;</span><span class=\"p\">...)</span>\n    <span class=\"n\">at</span> <span class=\"n\">assert</span><span class=\"p\">.</span><span class=\"nl\">c</span><span class=\"p\">:</span><span class=\"mi\">101</span>\n<span class=\"cp\">#4  0x00007fffac08e993 in boost::shared_ptr&lt;gazebo::physics::Model&gt;::operator-&gt;</span>\n    <span class=\"p\">(</span><span class=\"k\">this</span><span class=\"o\">=&lt;</span><span class=\"n\">optimized</span> <span class=\"n\">out</span><span class=\"o\">&gt;</span><span class=\"p\">)</span> <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">boost</span><span class=\"o\">/</span><span class=\"n\">smart_ptr</span><span class=\"o\">/</span><span class=\"n\">shared_ptr</span><span class=\"p\">.</span><span class=\"nl\">hpp</span><span class=\"p\">:</span><span class=\"mi\">653</span>\n<span class=\"cp\">#5  0x00007fffac093276 in operator-&gt; (this=&lt;optimized out&gt;)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">robocup3ds</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">Robocup3dsPlugin</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">459</span>\n<span class=\"cp\">#6  Robocup3dsPlugin::UpdateGameState (this=this@entry=0x7fff4401e9d0)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">robocup3ds</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">Robocup3dsPlugin</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">451</span>\n<span class=\"cp\">#7  0x00007fffac093450 in Robocup3dsPlugin::Update (this=0x7fff4401e9d0)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">robocup3ds</span><span class=\"o\">/</span><span class=\"n\">src</span><span class=\"o\">/</span><span class=\"n\">Robocup3dsPlugin</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">176</span>\n<span class=\"cp\">#8  0x00007ffff62e6c81 in operator() (a0=..., this=&lt;optimized out&gt;)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">include</span><span class=\"o\">/</span><span class=\"n\">boost</span><span class=\"o\">/</span><span class=\"n\">function</span><span class=\"o\">/</span><span class=\"n\">function_template</span><span class=\"p\">.</span><span class=\"nl\">hpp</span><span class=\"p\">:</span><span class=\"mi\">767</span>\n<span class=\"cp\">#9  Signal&lt;gazebo::common::UpdateInfo&gt; (_p=..., this=&lt;optimized out&gt;)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">common</span><span class=\"o\">/</span><span class=\"n\">Event</span><span class=\"p\">.</span><span class=\"nl\">hh</span><span class=\"p\">:</span><span class=\"mi\">377</span>\n<span class=\"cp\">#10 operator()&lt;gazebo::common::UpdateInfo&gt; (_p=..., this=&lt;optimized out&gt;)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">common</span><span class=\"o\">/</span><span class=\"n\">Event</span><span class=\"p\">.</span><span class=\"nl\">hh</span><span class=\"p\">:</span><span class=\"mi\">213</span>\n<span class=\"cp\">#11 gazebo::physics::World::Update (this=this@entry=0x1674840)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">physics</span><span class=\"o\">/</span><span class=\"n\">World</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">766</span>\n<span class=\"cp\">#12 0x00007ffff62f313f in gazebo::physics::World::Step (</span>\n    <span class=\"k\">this</span><span class=\"o\">=</span><span class=\"k\">this</span><span class=\"err\">@</span><span class=\"n\">entry</span><span class=\"o\">=</span><span class=\"mh\">0x1674840</span><span class=\"p\">)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">physics</span><span class=\"o\">/</span><span class=\"n\">World</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">698</span>\n<span class=\"cp\">#13 0x00007ffff62f3605 in gazebo::physics::World::RunLoop (this=0x1674840)</span>\n    <span class=\"n\">at</span> <span class=\"o\">/</span><span class=\"n\">home</span><span class=\"o\">/</span><span class=\"n\">caguero</span><span class=\"o\">/</span><span class=\"n\">workspace</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">gazebo</span><span class=\"o\">/</span><span class=\"n\">physics</span><span class=\"o\">/</span><span class=\"n\">World</span><span class=\"p\">.</span><span class=\"nl\">cc</span><span class=\"p\">:</span><span class=\"mi\">467</span>\n<span class=\"cp\">#14 0x00007ffff498309a in ?? ()</span>\n   <span class=\"n\">from</span> <span class=\"o\">/</span><span class=\"n\">usr</span><span class=\"o\">/</span><span class=\"n\">lib</span><span class=\"o\">/</span><span class=\"n\">x86_64</span><span class=\"o\">-</span><span class=\"n\">linux</span><span class=\"o\">-</span><span class=\"n\">gnu</span><span class=\"o\">/</span><span class=\"n\">libboost_thread</span><span class=\"p\">.</span><span class=\"n\">so</span><span class=\"mf\">.1.55.0</span>\n<span class=\"cp\">#15 0x00007ffff55f06aa in start_thread (arg=0x7fff90bf3700)</span>\n    <span class=\"n\">at</span> <span class=\"n\">pthread_create</span><span class=\"p\">.</span><span class=\"nl\">c</span><span class=\"p\">:</span><span class=\"mi\">333</span>\n<span class=\"cp\">#16 0x00007ffff695eeed in clone ()</span>\n    <span class=\"n\">at</span> <span class=\"p\">..</span><span class=\"o\">/</span><span class=\"n\">sysdeps</span><span class=\"o\">/</span><span class=\"n\">unix</span><span class=\"o\">/</span><span class=\"n\">sysv</span><span class=\"o\">/</span><span class=\"n\">linux</span><span class=\"o\">/</span><span class=\"n\">x86_64</span><span class=\"o\">/</span><span class=\"n\">clone</span><span class=\"p\">.</span><span class=\"nl\">S</span><span class=\"p\">:</span><span class=\"mi\">109</span>\n</pre></div>\n\n\n<p>It seems is related with the ball name. Do I need to update something?</p>", "type": "rendered"}, "created_on": "2015-08-17T19:03:51.722736+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": "2015-08-17T19:03:51.731027+00:00", "type": "pullrequest_comment", "id": 9148716}