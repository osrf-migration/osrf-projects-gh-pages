{"priority": "major", "kind": "bug", "repository": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds.json"}, "html": {"href": "#!/osrf/robocup3ds"}, "avatar": {"href": "data/bytebucket.org/ravatar/{920a9983-6b31-4842-b414-a2a01bf8a4e6}ts=c_plus_plus"}}, "type": "repository", "name": "robocup3ds", "full_name": "osrf/robocup3ds", "uuid": "{920a9983-6b31-4842-b414-a2a01bf8a4e6}"}, "links": {"attachments": {"href": "data/repositories/osrf/robocup3ds/issues/14/attachments_page=1.json"}, "self": {"href": "data/repositories/osrf/robocup3ds/issues/14.json"}, "watch": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/robocup3ds/issues/14/watch"}, "comments": {"href": "data/repositories/osrf/robocup3ds/issues/14/comments_page=1.json"}, "html": {"href": "#!/osrf/robocup3ds/issues/14/server-crash-after-client-disconnect"}, "vote": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/robocup3ds/issues/14/vote"}}, "reporter": {"display_name": "Stefan Glaser", "uuid": "{aebb30f2-1996-410c-80b1-ed53786c945b}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Baebb30f2-1996-410c-80b1-ed53786c945b%7D"}, "html": {"href": "https://bitbucket.org/%7Baebb30f2-1996-410c-80b1-ed53786c945b%7D/"}, "avatar": {"href": "https://bitbucket.org/account/umscht/avatar/"}}, "nickname": "umscht", "type": "user", "account_id": null}, "title": "Server crash after client disconnect", "component": null, "votes": 0, "watches": 1, "content": {"raw": "The server crashes after I disconnect my client from it with the following message:\r\n\r\n```\r\nRCPServer::Send() Socket not found.\r\nterminate called after throwing an instance of 'std::bad_alloc'\r\n  what():  std::bad_alloc\r\n```\r\n\r\nTo reproduce the problem, simply take the magma-protocol-tester from issue 12 (http://chaosscripting.net/files/magma-protocol-tester.zip), then:\r\n\r\n1. start gazebo with robocup3ds plugin and run the magma-protocol-tester GUI\r\n2. connect an agent (\"connect\" button)\r\n3. initialize it (\"Send init\" button) (after that confirm that the agent shows up in the simulator)\r\n4. hit the \"disconnect\" button\r\n\r\nIt seems like the server still tries to send messages to closed sockets, or doesn't handle the exception when the other side disconnects during a send-call.", "markup": "markdown", "html": "<p>The server crashes after I disconnect my client from it with the following message:</p>\n<div class=\"codehilite\"><pre><span></span>RCPServer::Send() Socket not found.\nterminate called after throwing an instance of &#39;std::bad_alloc&#39;\n  what():  std::bad_alloc\n</pre></div>\n\n\n<p>To reproduce the problem, simply take the magma-protocol-tester from issue 12 (<a href=\"http://chaosscripting.net/files/magma-protocol-tester.zip\" rel=\"nofollow\" class=\"ap-connect-link\">http://chaosscripting.net/files/magma-protocol-tester.zip</a>), then:</p>\n<ol>\n<li>start gazebo with robocup3ds plugin and run the magma-protocol-tester GUI</li>\n<li>connect an agent (\"connect\" button)</li>\n<li>initialize it (\"Send init\" button) (after that confirm that the agent shows up in the simulator)</li>\n<li>hit the \"disconnect\" button</li>\n</ol>\n<p>It seems like the server still tries to send messages to closed sockets, or doesn't handle the exception when the other side disconnects during a send-call.</p>", "type": "rendered"}, "assignee": {"display_name": "jasonzliang NA", "uuid": "{663c75f1-dde2-425c-aa25-68ad2f4eb5ec}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B663c75f1-dde2-425c-aa25-68ad2f4eb5ec%7D"}, "html": {"href": "https://bitbucket.org/%7B663c75f1-dde2-425c-aa25-68ad2f4eb5ec%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:4f6d7230-9817-448e-8b0d-98cb3dd0821c/5b9c099e-6241-49a1-ba1d-fabcca24c6c3/128"}}, "nickname": "jasonzliang", "type": "user", "account_id": "557058:4f6d7230-9817-448e-8b0d-98cb3dd0821c"}, "state": "resolved", "version": null, "edited_on": null, "created_on": "2016-01-18T14:13:28.417849+00:00", "milestone": null, "updated_on": "2016-03-08T01:52:27.954268+00:00", "type": "issue", "id": 14}