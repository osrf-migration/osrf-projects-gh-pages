{"pagelen": 100, "values": [{"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12/comments/23086344.json"}, "html": {"href": "#!/osrf/robocup3ds/issues/12#comment-23086344"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12.json"}}, "type": "issue", "id": 12, "repository": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds.json"}, "html": {"href": "#!/osrf/robocup3ds"}, "avatar": {"href": "data/bytebucket.org/ravatar/{920a9983-6b31-4842-b414-a2a01bf8a4e6}ts=c_plus_plus"}}, "type": "repository", "name": "robocup3ds", "full_name": "osrf/robocup3ds", "uuid": "{920a9983-6b31-4842-b414-a2a01bf8a4e6}"}, "title": "Deadlock in RCPServer::Send()"}, "content": {"raw": null, "markup": "markdown", "html": "", "type": "rendered"}, "created_on": "2015-11-05T11:45:23.724072+00:00", "user": {"display_name": "jasonzliang NA", "uuid": "{663c75f1-dde2-425c-aa25-68ad2f4eb5ec}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B663c75f1-dde2-425c-aa25-68ad2f4eb5ec%7D"}, "html": {"href": "https://bitbucket.org/%7B663c75f1-dde2-425c-aa25-68ad2f4eb5ec%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:4f6d7230-9817-448e-8b0d-98cb3dd0821c/5b9c099e-6241-49a1-ba1d-fabcca24c6c3/128"}}, "nickname": "jasonzliang", "type": "user", "account_id": "557058:4f6d7230-9817-448e-8b0d-98cb3dd0821c"}, "updated_on": null, "type": "issue_comment", "id": 23086344}, {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12/comments/23086359.json"}, "html": {"href": "#!/osrf/robocup3ds/issues/12#comment-23086359"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12.json"}}, "type": "issue", "id": 12, "repository": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds.json"}, "html": {"href": "#!/osrf/robocup3ds"}, "avatar": {"href": "data/bytebucket.org/ravatar/{920a9983-6b31-4842-b414-a2a01bf8a4e6}ts=c_plus_plus"}}, "type": "repository", "name": "robocup3ds", "full_name": "osrf/robocup3ds", "uuid": "{920a9983-6b31-4842-b414-a2a01bf8a4e6}"}, "title": "Deadlock in RCPServer::Send()"}, "content": {"raw": null, "markup": "markdown", "html": "", "type": "rendered"}, "created_on": "2015-11-05T11:45:46.754673+00:00", "user": {"display_name": "jasonzliang NA", "uuid": "{663c75f1-dde2-425c-aa25-68ad2f4eb5ec}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B663c75f1-dde2-425c-aa25-68ad2f4eb5ec%7D"}, "html": {"href": "https://bitbucket.org/%7B663c75f1-dde2-425c-aa25-68ad2f4eb5ec%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:4f6d7230-9817-448e-8b0d-98cb3dd0821c/5b9c099e-6241-49a1-ba1d-fabcca24c6c3/128"}}, "nickname": "jasonzliang", "type": "user", "account_id": "557058:4f6d7230-9817-448e-8b0d-98cb3dd0821c"}, "updated_on": null, "type": "issue_comment", "id": 23086359}, {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12/comments/23086707.json"}, "html": {"href": "#!/osrf/robocup3ds/issues/12#comment-23086707"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12.json"}}, "type": "issue", "id": 12, "repository": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds.json"}, "html": {"href": "#!/osrf/robocup3ds"}, "avatar": {"href": "data/bytebucket.org/ravatar/{920a9983-6b31-4842-b414-a2a01bf8a4e6}ts=c_plus_plus"}}, "type": "repository", "name": "robocup3ds", "full_name": "osrf/robocup3ds", "uuid": "{920a9983-6b31-4842-b414-a2a01bf8a4e6}"}, "title": "Deadlock in RCPServer::Send()"}, "content": {"raw": "Hi all,\nthe magma protocol tester has two \"send\" buttons. The \"send init\"-button sends the scene-string, the init-effector and a beam-effector at once. The other \"send\" button sends the text that is contained in the text-field next to it, which is initially \"(syn)\".\nSo, in order to reproduce the problem I usually do the following:\n\n1. Start gazebo and magma protocol tester\n2. Hit \"connect\" in protocol tester\n3. Hit \"send init\" button (it should send \"(scene NAO_Type_Zero) (init (unum 5) (teamname magmaOffenburg)) (beam 1 1 45.0)\" as one message)\n4. Confirm that agent is loaded on field and beamed correctly\n5. Hit the \"send\" button several times (sending a simple \"(syn)\" message) until the server freezes (usually after the first couple of times the server freezes)\n\nAlternatively you can send different messages, e.g. an action message for one of the neck joints: \"(he1 1.0)\"\n\nThe status bar lists the number of sent and received messages. This helps to verify that the server still sends perception messages.\n\nThe \"verbose\" checkbox enables or disables the output of perception-messages via std-out.", "markup": "markdown", "html": "<p>Hi all,\nthe magma protocol tester has two \"send\" buttons. The \"send init\"-button sends the scene-string, the init-effector and a beam-effector at once. The other \"send\" button sends the text that is contained in the text-field next to it, which is initially \"(syn)\".\nSo, in order to reproduce the problem I usually do the following:</p>\n<ol>\n<li>Start gazebo and magma protocol tester</li>\n<li>Hit \"connect\" in protocol tester</li>\n<li>Hit \"send init\" button (it should send \"(scene NAO_Type_Zero) (init (unum 5) (teamname magmaOffenburg)) (beam 1 1 45.0)\" as one message)</li>\n<li>Confirm that agent is loaded on field and beamed correctly</li>\n<li>Hit the \"send\" button several times (sending a simple \"(syn)\" message) until the server freezes (usually after the first couple of times the server freezes)</li>\n</ol>\n<p>Alternatively you can send different messages, e.g. an action message for one of the neck joints: \"(he1 1.0)\"</p>\n<p>The status bar lists the number of sent and received messages. This helps to verify that the server still sends perception messages.</p>\n<p>The \"verbose\" checkbox enables or disables the output of perception-messages via std-out.</p>", "type": "rendered"}, "created_on": "2015-11-05T12:00:47.790674+00:00", "user": {"display_name": "Stefan Glaser", "uuid": "{aebb30f2-1996-410c-80b1-ed53786c945b}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Baebb30f2-1996-410c-80b1-ed53786c945b%7D"}, "html": {"href": "https://bitbucket.org/%7Baebb30f2-1996-410c-80b1-ed53786c945b%7D/"}, "avatar": {"href": "https://bitbucket.org/account/umscht/avatar/"}}, "nickname": "umscht", "type": "user", "account_id": null}, "updated_on": "2015-11-05T12:24:03.949186+00:00", "type": "issue_comment", "id": 23086707}, {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12/comments/24500312.json"}, "html": {"href": "#!/osrf/robocup3ds/issues/12#comment-24500312"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12.json"}}, "type": "issue", "id": 12, "repository": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds.json"}, "html": {"href": "#!/osrf/robocup3ds"}, "avatar": {"href": "data/bytebucket.org/ravatar/{920a9983-6b31-4842-b414-a2a01bf8a4e6}ts=c_plus_plus"}}, "type": "repository", "name": "robocup3ds", "full_name": "osrf/robocup3ds", "uuid": "{920a9983-6b31-4842-b414-a2a01bf8a4e6}"}, "title": "Deadlock in RCPServer::Send()"}, "content": {"raw": "Actually, it was not a deadlock. This was the problem:\n\n1. We receive data from a client and we call `DispatchRequestOnClientSocket()`.\n2. We find the socket that has reported activity and we call `Parse()`.\n3. `Parse()` was trying to read 4 bytes containing the length of the following s-expression:\n\n```\n#!c++\n\nint endianSize = recv(_socket, this->buffer, 4, 0);\n```\n\nHere's the problem because we don't have any guarantee that we're going to read the entire 4 bytes here. We could read `2` for example. The code assumed that we were reading 4 bytes. \n\nSee pull request #42 for a solution.\n\n@umscht , @jasonzliang Could you give it a shot to confirm that the patch fixes the problem? You would have to compile `robocup3d` from sources.", "markup": "markdown", "html": "<p>Actually, it was not a deadlock. This was the problem:</p>\n<ol>\n<li>We receive data from a client and we call <code>DispatchRequestOnClientSocket()</code>.</li>\n<li>We find the socket that has reported activity and we call <code>Parse()</code>.</li>\n<li><code>Parse()</code> was trying to read 4 bytes containing the length of the following s-expression:</li>\n</ol>\n<div class=\"codehilite language-c++\"><pre><span></span><span class=\"kt\">int</span> <span class=\"n\">endianSize</span> <span class=\"o\">=</span> <span class=\"n\">recv</span><span class=\"p\">(</span><span class=\"n\">_socket</span><span class=\"p\">,</span> <span class=\"k\">this</span><span class=\"o\">-&gt;</span><span class=\"n\">buffer</span><span class=\"p\">,</span> <span class=\"mi\">4</span><span class=\"p\">,</span> <span class=\"mi\">0</span><span class=\"p\">);</span>\n</pre></div>\n\n\n<p>Here's the problem because we don't have any guarantee that we're going to read the entire 4 bytes here. We could read <code>2</code> for example. The code assumed that we were reading 4 bytes. </p>\n<p>See <a href=\"#!/osrf/robocup3ds/pull-requests/42/fix-issue-12\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #42</a> for a solution.</p>\n<p>@umscht , @jasonzliang Could you give it a shot to confirm that the patch fixes the problem? You would have to compile <code>robocup3d</code> from sources.</p>", "type": "rendered"}, "created_on": "2016-01-06T01:17:21.839365+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": "2016-01-06T01:20:51.882204+00:00", "type": "issue_comment", "id": 24500312}, {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12/comments/24510228.json"}, "html": {"href": "#!/osrf/robocup3ds/issues/12#comment-24510228"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12.json"}}, "type": "issue", "id": 12, "repository": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds.json"}, "html": {"href": "#!/osrf/robocup3ds"}, "avatar": {"href": "data/bytebucket.org/ravatar/{920a9983-6b31-4842-b414-a2a01bf8a4e6}ts=c_plus_plus"}}, "type": "repository", "name": "robocup3ds", "full_name": "osrf/robocup3ds", "uuid": "{920a9983-6b31-4842-b414-a2a01bf8a4e6}"}, "title": "Deadlock in RCPServer::Send()"}, "content": {"raw": "Hi Carlos,\nthis definitely looks like an error source. Especially since we turned off buffering in the TCP/IP stack and send the length information byte by byte.\n\nI tested your fix in pull request #42 and it solves this issue for our agent and the protocol-tester tool I provided.\nWe can connect, initialize, beam and send commands without crashing.\n\nBut, I also noticed that when I disconnect my agent, the server still crashes with the following output:\n\n```\nRCPServer::Send() Socket not found.\nterminate called after throwing an instance of 'std::bad_alloc'\n  what():  std::bad_alloc\n```\n\nShould I open another issue for that?\n\nThank you very much for your effort!", "markup": "markdown", "html": "<p>Hi Carlos,\nthis definitely looks like an error source. Especially since we turned off buffering in the TCP/IP stack and send the length information byte by byte.</p>\n<p>I tested your fix in <a href=\"#!/osrf/robocup3ds/pull-requests/42/fix-issue-12\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #42</a> and it solves this issue for our agent and the protocol-tester tool I provided.\nWe can connect, initialize, beam and send commands without crashing.</p>\n<p>But, I also noticed that when I disconnect my agent, the server still crashes with the following output:</p>\n<div class=\"codehilite\"><pre><span></span>RCPServer::Send() Socket not found.\nterminate called after throwing an instance of &#39;std::bad_alloc&#39;\n  what():  std::bad_alloc\n</pre></div>\n\n\n<p>Should I open another issue for that?</p>\n<p>Thank you very much for your effort!</p>", "type": "rendered"}, "created_on": "2016-01-06T10:33:48.700681+00:00", "user": {"display_name": "Stefan Glaser", "uuid": "{aebb30f2-1996-410c-80b1-ed53786c945b}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Baebb30f2-1996-410c-80b1-ed53786c945b%7D"}, "html": {"href": "https://bitbucket.org/%7Baebb30f2-1996-410c-80b1-ed53786c945b%7D/"}, "avatar": {"href": "https://bitbucket.org/account/umscht/avatar/"}}, "nickname": "umscht", "type": "user", "account_id": null}, "updated_on": null, "type": "issue_comment", "id": 24510228}, {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12/comments/24521321.json"}, "html": {"href": "#!/osrf/robocup3ds/issues/12#comment-24521321"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12.json"}}, "type": "issue", "id": 12, "repository": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds.json"}, "html": {"href": "#!/osrf/robocup3ds"}, "avatar": {"href": "data/bytebucket.org/ravatar/{920a9983-6b31-4842-b414-a2a01bf8a4e6}ts=c_plus_plus"}}, "type": "repository", "name": "robocup3ds", "full_name": "osrf/robocup3ds", "uuid": "{920a9983-6b31-4842-b414-a2a01bf8a4e6}"}, "title": "Deadlock in RCPServer::Send()"}, "content": {"raw": "That seems a different problem. It would be awesome if you can create a separate issue, thanks!\n\nYou can also comment/approve the pull request.", "markup": "markdown", "html": "<p>That seems a different problem. It would be awesome if you can create a separate issue, thanks!</p>\n<p>You can also comment/approve the pull request.</p>", "type": "rendered"}, "created_on": "2016-01-06T19:28:05.693432+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": "2016-01-06T19:29:03.853192+00:00", "type": "issue_comment", "id": 24521321}, {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12/comments/24656425.json"}, "html": {"href": "#!/osrf/robocup3ds/issues/12#comment-24656425"}}, "issue": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds/issues/12.json"}}, "type": "issue", "id": 12, "repository": {"links": {"self": {"href": "data/repositories/osrf/robocup3ds.json"}, "html": {"href": "#!/osrf/robocup3ds"}, "avatar": {"href": "data/bytebucket.org/ravatar/{920a9983-6b31-4842-b414-a2a01bf8a4e6}ts=c_plus_plus"}}, "type": "repository", "name": "robocup3ds", "full_name": "osrf/robocup3ds", "uuid": "{920a9983-6b31-4842-b414-a2a01bf8a4e6}"}, "title": "Deadlock in RCPServer::Send()"}, "content": {"raw": "Merged in issue_12 (pull request #42)\n\nFix issue #12\n\n\u2192 <<cset 2c3aca8efb1f>>", "markup": "markdown", "html": "<p>Merged in issue_12 (<a href=\"#!/osrf/robocup3ds/pull-requests/42/fix-issue-12\" rel=\"nofollow\" class=\"ap-connect-link\">pull request #42</a>)</p>\n<p>Fix issue <a href=\"#!/osrf/robocup3ds/issues/12/deadlock-in-rcpserver-send\" rel=\"nofollow\" title=\"Deadlock in RCPServer::Send()\" class=\"ap-connect-link\"><s>#12</s></a></p>\n<p>\u2192 &lt;&lt;cset <a href=\"#!/osrf/robocup3ds/commits/2c3aca8efb1f\" rel=\"nofollow\" class=\"ap-connect-link\">2c3aca8efb1f</a>&gt;&gt;</p>", "type": "rendered"}, "created_on": "2016-01-12T22:44:43.315346+00:00", "user": {"display_name": "Carlos Ag\u00fcero", "uuid": "{da8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D"}, "html": {"href": "https://bitbucket.org/%7Bda8a8e89-4bb0-421b-bd0e-dbbed3d4ed6a%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/692bf15758111acaddae4da15a47f9e5d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsCA-0.png"}}, "nickname": "caguero", "type": "user", "account_id": "557058:4ded1ddf-947e-4154-bbd1-3dba24f1bdbd"}, "updated_on": null, "type": "issue_comment", "id": 24656425}], "page": 1, "size": 7}