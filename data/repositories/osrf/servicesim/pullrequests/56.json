{"rendered": {"description": {"raw": "This adds a penalty for when the robot gets too close to a human and/or an object.\r\n\r\nThere are two cylinders around the robot of different radii, one checks approximations to humans, the other checks approximation to objects:\r\n\r\n![radii.png](data/bitbucket.org/repo/gkR8znK/images/2553629878-radii.png)\r\n\r\nThis results in no penalties, because the larger cylinder checks against humans:\r\n\r\n![col3.png](data/bitbucket.org/repo/gkR8znK/images/1427296655-col3.png)\r\n\r\nThis results in human approximation penalties:\r\n\r\n![col4.png](data/bitbucket.org/repo/gkR8znK/images/2549838075-col4.png)\r\n\r\nThis results in object approximation penalties:\r\n\r\n![col5.png](data/bitbucket.org/repo/gkR8znK/images/103347638-col5.png)\r\n\r\n\r\n## Known issue\r\n\r\nRight now, when the robot is close to the world origin, it thinks it is colliding with the guest, who is far far away in the private cafe:\r\n\r\n![originbug.png](data/bitbucket.org/repo/gkR8znK/images/913326091-originbug.png)\r\n\r\nI suspect this is a physics bug because the guest has never been animated, I'll leave it as an open issue for now.\r\n\r\n## Inflation plugin\r\n\r\nAll the new plugin does is setting [collide_without_contact](http://sdformat.org/spec?ver=1.6&elem=collision#contact_collide_without_contact) to true for the \"inflation\" collisions. I tried a few things to set it directly on URDF but they didn't work.\r\n\r\nThese collide *with* contact:\r\n\r\n~~~\r\ndiff -r 478352015077 servicebot_description/urdf/servicebot.urdf\r\n--- a/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:09:47 2018 -0800\r\n+++ b/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:20:02 2018 -0800\r\n@@ -28,12 +28,14 @@\r\n       <geometry>\r\n         <cylinder radius=\"0.75\" length=\"1.07\"/>\r\n       </geometry>\r\n+      <collideWithoutContact>true</collideWithoutContact>\r\n     </collision>\r\n     <collision name=\"inflation_objs\">\r\n       <origin rpy=\"0 0 -0.08\" xyz=\"0 0 0\"/>\r\n~~~\r\n\r\n\r\n~~~\r\ndiff -r 478352015077 servicebot_description/urdf/servicebot.urdf\r\n--- a/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:09:47 2018 -0800\r\n+++ b/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:27:02 2018 -0800\r\n@@ -28,6 +28,11 @@\r\n       <geometry>\r\n         <cylinder radius=\"0.75\" length=\"1.07\"/>\r\n       </geometry>\r\n+      <surface>\r\n+        <contact>\r\n+          <collide_without_contact>true</collide_without_contact>\r\n+        </contact>\r\n+      </surface>\r\n     </collision>\r\n     <collision name=\"inflation_objs\">\r\n       <origin rpy=\"0 0 -0.08\" xyz=\"0 0 0\"/>\r\n~~~\r\n\r\nThis crashes the URDF parser:\r\n\r\n~~~\r\ndiff -r 478352015077 servicebot_description/urdf/servicebot.urdf\r\n--- a/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:09:47 2018 -0800\r\n+++ b/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:35:09 2018 -0800\r\n@@ -865,13 +852,21 @@\r\n     </sensor>\r\n   </gazebo>\r\n\r\n+  <gazebo reference=\"base_link\">\r\n+    <collision name=\"inflation\">\r\n+      <geometry>\r\n+        <cylinder>\r\n+          <radius>0.5</radius>\r\n+          <length>1.0</length>\r\n+        </cylinder>\r\n+      </geometry>\r\n+      <surface>\r\n+        <contact>\r\n+          <collide_without_contact>true</collide_without_contact>\r\n+        </contact>\r\n+      </surface>\r\n+    </collision>\r\n   </gazebo>\r\n-\r\n   <gazebo reference=\"base_link\">\r\n     <mu1>0.5</mu1>\r\n\r\n~~~\r\n\r\nwith this backtrace:\r\n\r\n~~~\r\n#0  0x00007ffff457f6ed in InsertSDFExtensionCollision (_elem=0x7ffec8a2b5a0, _linkName=\"base_link\")\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:1904\r\n#1  0x00007ffff459bca0 in CreateCollision (_elem=0x7ffec89d2f40, _link=..., _collision=..., _oldLinkName=\"base_link_collision\")\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3408\r\n#2  0x00007ffff4594b7d in CreateCollisions (_elem=0x7ffec89d2f40, _link=...) at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3038\r\n#3  0x00007ffff4593d89 in CreateLink (_root=0x7ffec89d56d0, _link=..., _currentTransform=...)\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2908\r\n#4  0x00007ffff459287c in CreateSDF (_root=0x7ffec89d56d0, _link=..., _transform=...)\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2842\r\n#5  0x00007ffff459da2e in sdf::URDF2SDF::InitModelString (this=0x7ffedb7fc24f, \r\n    _urdfStr=\"<robot name=\\\"servicebot\\\"><!-- Note: this doesnt follow REP 120 as this robot, while having a humanoid shape, will behave like a mobile base --><!-- setting the base_link as the center of mass of the t\"..., _enforceLimits=true)\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3523\r\n~~~", "markup": "markdown", "html": "<p>This adds a penalty for when the robot gets too close to a human and/or an object.</p>\n<p>There are two cylinders around the robot of different radii, one checks approximations to humans, the other checks approximation to objects:</p>\n<p><img alt=\"radii.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/2553629878-radii.png\" /></p>\n<p>This results in no penalties, because the larger cylinder checks against humans:</p>\n<p><img alt=\"col3.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/1427296655-col3.png\" /></p>\n<p>This results in human approximation penalties:</p>\n<p><img alt=\"col4.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/2549838075-col4.png\" /></p>\n<p>This results in object approximation penalties:</p>\n<p><img alt=\"col5.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/103347638-col5.png\" /></p>\n<h2 id=\"markdown-header-known-issue\">Known issue</h2>\n<p>Right now, when the robot is close to the world origin, it thinks it is colliding with the guest, who is far far away in the private cafe:</p>\n<p><img alt=\"originbug.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/913326091-originbug.png\" /></p>\n<p>I suspect this is a physics bug because the guest has never been animated, I'll leave it as an open issue for now.</p>\n<h2 id=\"markdown-header-inflation-plugin\">Inflation plugin</h2>\n<p>All the new plugin does is setting <a data-is-external-link=\"true\" href=\"http://sdformat.org/spec?ver=1.6&amp;elem=collision#contact_collide_without_contact\" rel=\"nofollow\">collide_without_contact</a> to true for the \"inflation\" collisions. I tried a few things to set it directly on URDF but they didn't work.</p>\n<p>These collide <em>with</em> contact:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 478352015077 servicebot_description/urdf/servicebot.urdf</span>\n<span class=\"gd\">--- a/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:09:47 2018 -0800</span>\n<span class=\"gi\">+++ b/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:20:02 2018 -0800</span>\n<span class=\"gu\">@@ -28,12 +28,14 @@</span>\n       &lt;geometry&gt;\n         &lt;cylinder radius=&quot;0.75&quot; length=&quot;1.07&quot;/&gt;\n       &lt;/geometry&gt;\n<span class=\"gi\">+      &lt;collideWithoutContact&gt;true&lt;/collideWithoutContact&gt;</span>\n     &lt;/collision&gt;\n     &lt;collision name=&quot;inflation_objs&quot;&gt;\n       &lt;origin rpy=&quot;0 0 -0.08&quot; xyz=&quot;0 0 0&quot;/&gt;\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 478352015077 servicebot_description/urdf/servicebot.urdf</span>\n<span class=\"gd\">--- a/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:09:47 2018 -0800</span>\n<span class=\"gi\">+++ b/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:27:02 2018 -0800</span>\n<span class=\"gu\">@@ -28,6 +28,11 @@</span>\n       &lt;geometry&gt;\n         &lt;cylinder radius=&quot;0.75&quot; length=&quot;1.07&quot;/&gt;\n       &lt;/geometry&gt;\n<span class=\"gi\">+      &lt;surface&gt;</span>\n<span class=\"gi\">+        &lt;contact&gt;</span>\n<span class=\"gi\">+          &lt;collide_without_contact&gt;true&lt;/collide_without_contact&gt;</span>\n<span class=\"gi\">+        &lt;/contact&gt;</span>\n<span class=\"gi\">+      &lt;/surface&gt;</span>\n     &lt;/collision&gt;\n     &lt;collision name=&quot;inflation_objs&quot;&gt;\n       &lt;origin rpy=&quot;0 0 -0.08&quot; xyz=&quot;0 0 0&quot;/&gt;\n</pre></div>\n\n\n<p>This crashes the URDF parser:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 478352015077 servicebot_description/urdf/servicebot.urdf</span>\n<span class=\"gd\">--- a/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:09:47 2018 -0800</span>\n<span class=\"gi\">+++ b/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:35:09 2018 -0800</span>\n<span class=\"gu\">@@ -865,13 +852,21 @@</span>\n     &lt;/sensor&gt;\n   &lt;/gazebo&gt;\n\n<span class=\"gi\">+  &lt;gazebo reference=&quot;base_link&quot;&gt;</span>\n<span class=\"gi\">+    &lt;collision name=&quot;inflation&quot;&gt;</span>\n<span class=\"gi\">+      &lt;geometry&gt;</span>\n<span class=\"gi\">+        &lt;cylinder&gt;</span>\n<span class=\"gi\">+          &lt;radius&gt;0.5&lt;/radius&gt;</span>\n<span class=\"gi\">+          &lt;length&gt;1.0&lt;/length&gt;</span>\n<span class=\"gi\">+        &lt;/cylinder&gt;</span>\n<span class=\"gi\">+      &lt;/geometry&gt;</span>\n<span class=\"gi\">+      &lt;surface&gt;</span>\n<span class=\"gi\">+        &lt;contact&gt;</span>\n<span class=\"gi\">+          &lt;collide_without_contact&gt;true&lt;/collide_without_contact&gt;</span>\n<span class=\"gi\">+        &lt;/contact&gt;</span>\n<span class=\"gi\">+      &lt;/surface&gt;</span>\n<span class=\"gi\">+    &lt;/collision&gt;</span>\n   &lt;/gazebo&gt;\n<span class=\"gd\">-</span>\n   &lt;gazebo reference=&quot;base_link&quot;&gt;\n     &lt;mu1&gt;0.5&lt;/mu1&gt;\n</pre></div>\n\n\n<p>with this backtrace:</p>\n<div class=\"codehilite\"><pre><span></span>#0  0x00007ffff457f6ed in InsertSDFExtensionCollision (_elem=0x7ffec8a2b5a0, _linkName=&quot;base_link&quot;)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:1904\n#1  0x00007ffff459bca0 in CreateCollision (_elem=0x7ffec89d2f40, _link=..., _collision=..., _oldLinkName=&quot;base_link_collision&quot;)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3408\n#2  0x00007ffff4594b7d in CreateCollisions (_elem=0x7ffec89d2f40, _link=...) at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3038\n#3  0x00007ffff4593d89 in CreateLink (_root=0x7ffec89d56d0, _link=..., _currentTransform=...)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2908\n#4  0x00007ffff459287c in CreateSDF (_root=0x7ffec89d56d0, _link=..., _transform=...)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2842\n#5  0x00007ffff459da2e in sdf::URDF2SDF::InitModelString (this=0x7ffedb7fc24f, \n    _urdfStr=&quot;&lt;robot name=\\&quot;servicebot\\&quot;&gt;&lt;!-- Note: this doesnt follow REP 120 as this robot, while having a humanoid shape, will behave like a mobile base --&gt;&lt;!-- setting the base_link as the center of mass of the t&quot;..., _enforceLimits=true)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3523\n</pre></div>", "type": "rendered"}, "title": {"raw": "Approximation penalty", "markup": "markdown", "html": "<p>Approximation penalty</p>", "type": "rendered"}}, "type": "pullrequest", "description": "This adds a penalty for when the robot gets too close to a human and/or an object.\r\n\r\nThere are two cylinders around the robot of different radii, one checks approximations to humans, the other checks approximation to objects:\r\n\r\n![radii.png](data/bitbucket.org/repo/gkR8znK/images/2553629878-radii.png)\r\n\r\nThis results in no penalties, because the larger cylinder checks against humans:\r\n\r\n![col3.png](data/bitbucket.org/repo/gkR8znK/images/1427296655-col3.png)\r\n\r\nThis results in human approximation penalties:\r\n\r\n![col4.png](data/bitbucket.org/repo/gkR8znK/images/2549838075-col4.png)\r\n\r\nThis results in object approximation penalties:\r\n\r\n![col5.png](data/bitbucket.org/repo/gkR8znK/images/103347638-col5.png)\r\n\r\n\r\n## Known issue\r\n\r\nRight now, when the robot is close to the world origin, it thinks it is colliding with the guest, who is far far away in the private cafe:\r\n\r\n![originbug.png](data/bitbucket.org/repo/gkR8znK/images/913326091-originbug.png)\r\n\r\nI suspect this is a physics bug because the guest has never been animated, I'll leave it as an open issue for now.\r\n\r\n## Inflation plugin\r\n\r\nAll the new plugin does is setting [collide_without_contact](http://sdformat.org/spec?ver=1.6&elem=collision#contact_collide_without_contact) to true for the \"inflation\" collisions. I tried a few things to set it directly on URDF but they didn't work.\r\n\r\nThese collide *with* contact:\r\n\r\n~~~\r\ndiff -r 478352015077 servicebot_description/urdf/servicebot.urdf\r\n--- a/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:09:47 2018 -0800\r\n+++ b/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:20:02 2018 -0800\r\n@@ -28,12 +28,14 @@\r\n       <geometry>\r\n         <cylinder radius=\"0.75\" length=\"1.07\"/>\r\n       </geometry>\r\n+      <collideWithoutContact>true</collideWithoutContact>\r\n     </collision>\r\n     <collision name=\"inflation_objs\">\r\n       <origin rpy=\"0 0 -0.08\" xyz=\"0 0 0\"/>\r\n~~~\r\n\r\n\r\n~~~\r\ndiff -r 478352015077 servicebot_description/urdf/servicebot.urdf\r\n--- a/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:09:47 2018 -0800\r\n+++ b/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:27:02 2018 -0800\r\n@@ -28,6 +28,11 @@\r\n       <geometry>\r\n         <cylinder radius=\"0.75\" length=\"1.07\"/>\r\n       </geometry>\r\n+      <surface>\r\n+        <contact>\r\n+          <collide_without_contact>true</collide_without_contact>\r\n+        </contact>\r\n+      </surface>\r\n     </collision>\r\n     <collision name=\"inflation_objs\">\r\n       <origin rpy=\"0 0 -0.08\" xyz=\"0 0 0\"/>\r\n~~~\r\n\r\nThis crashes the URDF parser:\r\n\r\n~~~\r\ndiff -r 478352015077 servicebot_description/urdf/servicebot.urdf\r\n--- a/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:09:47 2018 -0800\r\n+++ b/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:35:09 2018 -0800\r\n@@ -865,13 +852,21 @@\r\n     </sensor>\r\n   </gazebo>\r\n\r\n+  <gazebo reference=\"base_link\">\r\n+    <collision name=\"inflation\">\r\n+      <geometry>\r\n+        <cylinder>\r\n+          <radius>0.5</radius>\r\n+          <length>1.0</length>\r\n+        </cylinder>\r\n+      </geometry>\r\n+      <surface>\r\n+        <contact>\r\n+          <collide_without_contact>true</collide_without_contact>\r\n+        </contact>\r\n+      </surface>\r\n+    </collision>\r\n   </gazebo>\r\n-\r\n   <gazebo reference=\"base_link\">\r\n     <mu1>0.5</mu1>\r\n\r\n~~~\r\n\r\nwith this backtrace:\r\n\r\n~~~\r\n#0  0x00007ffff457f6ed in InsertSDFExtensionCollision (_elem=0x7ffec8a2b5a0, _linkName=\"base_link\")\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:1904\r\n#1  0x00007ffff459bca0 in CreateCollision (_elem=0x7ffec89d2f40, _link=..., _collision=..., _oldLinkName=\"base_link_collision\")\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3408\r\n#2  0x00007ffff4594b7d in CreateCollisions (_elem=0x7ffec89d2f40, _link=...) at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3038\r\n#3  0x00007ffff4593d89 in CreateLink (_root=0x7ffec89d56d0, _link=..., _currentTransform=...)\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2908\r\n#4  0x00007ffff459287c in CreateSDF (_root=0x7ffec89d56d0, _link=..., _transform=...)\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2842\r\n#5  0x00007ffff459da2e in sdf::URDF2SDF::InitModelString (this=0x7ffedb7fc24f, \r\n    _urdfStr=\"<robot name=\\\"servicebot\\\"><!-- Note: this doesnt follow REP 120 as this robot, while having a humanoid shape, will behave like a mobile base --><!-- setting the base_link as the center of mass of the t\"..., _enforceLimits=true)\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3523\r\n~~~", "links": {"decline": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/servicesim/pullrequests/56/decline"}, "diffstat": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/servicesim/diffstat/osrf/servicesim:20fccb347ebf%0D58b8e7a5918b?from_pullrequest_id=56"}, "commits": {"href": "data/repositories/osrf/servicesim/pullrequests/56/commits.json"}, "self": {"href": "data/repositories/osrf/servicesim/pullrequests/56.json"}, "comments": {"href": "data/repositories/osrf/servicesim/pullrequests/56/comments_page=1.json"}, "merge": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/servicesim/pullrequests/56/merge"}, "html": {"href": "#!/osrf/servicesim/pull-requests/56"}, "activity": {"href": "data/repositories/osrf/servicesim/pullrequests/56/activity.json"}, "diff": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/servicesim/diff/osrf/servicesim:20fccb347ebf%0D58b8e7a5918b?from_pullrequest_id=56"}, "approve": {"href": "https://api.bitbucket.org/2.0/repositories/osrf/servicesim/pullrequests/56/approve"}, "statuses": {"href": "data/repositories/osrf/servicesim/pullrequests/56/statuses_page=1.json"}}, "title": "Approximation penalty", "close_source_branch": true, "reviewers": [], "id": 56, "destination": {"commit": {"hash": "58b8e7a5918b", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/servicesim/commit/58b8e7a5918b.json"}, "html": {"href": "#!/osrf/servicesim/commits/58b8e7a5918b"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/servicesim.json"}, "html": {"href": "#!/osrf/servicesim"}, "avatar": {"href": "data/bytebucket.org/ravatar/{3f537f5a-62ec-4117-968f-73e9064ad028}ts=c_plus_plus"}}, "type": "repository", "name": "servicesim", "full_name": "osrf/servicesim", "uuid": "{3f537f5a-62ec-4117-968f-73e9064ad028}"}, "branch": {"name": "default"}}, "created_on": "2018-02-22T02:37:33.389767+00:00", "summary": {"raw": "This adds a penalty for when the robot gets too close to a human and/or an object.\r\n\r\nThere are two cylinders around the robot of different radii, one checks approximations to humans, the other checks approximation to objects:\r\n\r\n![radii.png](data/bitbucket.org/repo/gkR8znK/images/2553629878-radii.png)\r\n\r\nThis results in no penalties, because the larger cylinder checks against humans:\r\n\r\n![col3.png](data/bitbucket.org/repo/gkR8znK/images/1427296655-col3.png)\r\n\r\nThis results in human approximation penalties:\r\n\r\n![col4.png](data/bitbucket.org/repo/gkR8znK/images/2549838075-col4.png)\r\n\r\nThis results in object approximation penalties:\r\n\r\n![col5.png](data/bitbucket.org/repo/gkR8znK/images/103347638-col5.png)\r\n\r\n\r\n## Known issue\r\n\r\nRight now, when the robot is close to the world origin, it thinks it is colliding with the guest, who is far far away in the private cafe:\r\n\r\n![originbug.png](data/bitbucket.org/repo/gkR8znK/images/913326091-originbug.png)\r\n\r\nI suspect this is a physics bug because the guest has never been animated, I'll leave it as an open issue for now.\r\n\r\n## Inflation plugin\r\n\r\nAll the new plugin does is setting [collide_without_contact](http://sdformat.org/spec?ver=1.6&elem=collision#contact_collide_without_contact) to true for the \"inflation\" collisions. I tried a few things to set it directly on URDF but they didn't work.\r\n\r\nThese collide *with* contact:\r\n\r\n~~~\r\ndiff -r 478352015077 servicebot_description/urdf/servicebot.urdf\r\n--- a/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:09:47 2018 -0800\r\n+++ b/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:20:02 2018 -0800\r\n@@ -28,12 +28,14 @@\r\n       <geometry>\r\n         <cylinder radius=\"0.75\" length=\"1.07\"/>\r\n       </geometry>\r\n+      <collideWithoutContact>true</collideWithoutContact>\r\n     </collision>\r\n     <collision name=\"inflation_objs\">\r\n       <origin rpy=\"0 0 -0.08\" xyz=\"0 0 0\"/>\r\n~~~\r\n\r\n\r\n~~~\r\ndiff -r 478352015077 servicebot_description/urdf/servicebot.urdf\r\n--- a/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:09:47 2018 -0800\r\n+++ b/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:27:02 2018 -0800\r\n@@ -28,6 +28,11 @@\r\n       <geometry>\r\n         <cylinder radius=\"0.75\" length=\"1.07\"/>\r\n       </geometry>\r\n+      <surface>\r\n+        <contact>\r\n+          <collide_without_contact>true</collide_without_contact>\r\n+        </contact>\r\n+      </surface>\r\n     </collision>\r\n     <collision name=\"inflation_objs\">\r\n       <origin rpy=\"0 0 -0.08\" xyz=\"0 0 0\"/>\r\n~~~\r\n\r\nThis crashes the URDF parser:\r\n\r\n~~~\r\ndiff -r 478352015077 servicebot_description/urdf/servicebot.urdf\r\n--- a/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:09:47 2018 -0800\r\n+++ b/servicebot_description/urdf/servicebot.urdf\tWed Feb 21 18:35:09 2018 -0800\r\n@@ -865,13 +852,21 @@\r\n     </sensor>\r\n   </gazebo>\r\n\r\n+  <gazebo reference=\"base_link\">\r\n+    <collision name=\"inflation\">\r\n+      <geometry>\r\n+        <cylinder>\r\n+          <radius>0.5</radius>\r\n+          <length>1.0</length>\r\n+        </cylinder>\r\n+      </geometry>\r\n+      <surface>\r\n+        <contact>\r\n+          <collide_without_contact>true</collide_without_contact>\r\n+        </contact>\r\n+      </surface>\r\n+    </collision>\r\n   </gazebo>\r\n-\r\n   <gazebo reference=\"base_link\">\r\n     <mu1>0.5</mu1>\r\n\r\n~~~\r\n\r\nwith this backtrace:\r\n\r\n~~~\r\n#0  0x00007ffff457f6ed in InsertSDFExtensionCollision (_elem=0x7ffec8a2b5a0, _linkName=\"base_link\")\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:1904\r\n#1  0x00007ffff459bca0 in CreateCollision (_elem=0x7ffec89d2f40, _link=..., _collision=..., _oldLinkName=\"base_link_collision\")\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3408\r\n#2  0x00007ffff4594b7d in CreateCollisions (_elem=0x7ffec89d2f40, _link=...) at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3038\r\n#3  0x00007ffff4593d89 in CreateLink (_root=0x7ffec89d56d0, _link=..., _currentTransform=...)\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2908\r\n#4  0x00007ffff459287c in CreateSDF (_root=0x7ffec89d56d0, _link=..., _transform=...)\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2842\r\n#5  0x00007ffff459da2e in sdf::URDF2SDF::InitModelString (this=0x7ffedb7fc24f, \r\n    _urdfStr=\"<robot name=\\\"servicebot\\\"><!-- Note: this doesnt follow REP 120 as this robot, while having a humanoid shape, will behave like a mobile base --><!-- setting the base_link as the center of mass of the t\"..., _enforceLimits=true)\r\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3523\r\n~~~", "markup": "markdown", "html": "<p>This adds a penalty for when the robot gets too close to a human and/or an object.</p>\n<p>There are two cylinders around the robot of different radii, one checks approximations to humans, the other checks approximation to objects:</p>\n<p><img alt=\"radii.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/2553629878-radii.png\" /></p>\n<p>This results in no penalties, because the larger cylinder checks against humans:</p>\n<p><img alt=\"col3.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/1427296655-col3.png\" /></p>\n<p>This results in human approximation penalties:</p>\n<p><img alt=\"col4.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/2549838075-col4.png\" /></p>\n<p>This results in object approximation penalties:</p>\n<p><img alt=\"col5.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/103347638-col5.png\" /></p>\n<h2 id=\"markdown-header-known-issue\">Known issue</h2>\n<p>Right now, when the robot is close to the world origin, it thinks it is colliding with the guest, who is far far away in the private cafe:</p>\n<p><img alt=\"originbug.png\" src=\"data/bitbucket.org/repo/gkR8znK/images/913326091-originbug.png\" /></p>\n<p>I suspect this is a physics bug because the guest has never been animated, I'll leave it as an open issue for now.</p>\n<h2 id=\"markdown-header-inflation-plugin\">Inflation plugin</h2>\n<p>All the new plugin does is setting <a data-is-external-link=\"true\" href=\"http://sdformat.org/spec?ver=1.6&amp;elem=collision#contact_collide_without_contact\" rel=\"nofollow\">collide_without_contact</a> to true for the \"inflation\" collisions. I tried a few things to set it directly on URDF but they didn't work.</p>\n<p>These collide <em>with</em> contact:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 478352015077 servicebot_description/urdf/servicebot.urdf</span>\n<span class=\"gd\">--- a/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:09:47 2018 -0800</span>\n<span class=\"gi\">+++ b/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:20:02 2018 -0800</span>\n<span class=\"gu\">@@ -28,12 +28,14 @@</span>\n       &lt;geometry&gt;\n         &lt;cylinder radius=&quot;0.75&quot; length=&quot;1.07&quot;/&gt;\n       &lt;/geometry&gt;\n<span class=\"gi\">+      &lt;collideWithoutContact&gt;true&lt;/collideWithoutContact&gt;</span>\n     &lt;/collision&gt;\n     &lt;collision name=&quot;inflation_objs&quot;&gt;\n       &lt;origin rpy=&quot;0 0 -0.08&quot; xyz=&quot;0 0 0&quot;/&gt;\n</pre></div>\n\n\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 478352015077 servicebot_description/urdf/servicebot.urdf</span>\n<span class=\"gd\">--- a/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:09:47 2018 -0800</span>\n<span class=\"gi\">+++ b/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:27:02 2018 -0800</span>\n<span class=\"gu\">@@ -28,6 +28,11 @@</span>\n       &lt;geometry&gt;\n         &lt;cylinder radius=&quot;0.75&quot; length=&quot;1.07&quot;/&gt;\n       &lt;/geometry&gt;\n<span class=\"gi\">+      &lt;surface&gt;</span>\n<span class=\"gi\">+        &lt;contact&gt;</span>\n<span class=\"gi\">+          &lt;collide_without_contact&gt;true&lt;/collide_without_contact&gt;</span>\n<span class=\"gi\">+        &lt;/contact&gt;</span>\n<span class=\"gi\">+      &lt;/surface&gt;</span>\n     &lt;/collision&gt;\n     &lt;collision name=&quot;inflation_objs&quot;&gt;\n       &lt;origin rpy=&quot;0 0 -0.08&quot; xyz=&quot;0 0 0&quot;/&gt;\n</pre></div>\n\n\n<p>This crashes the URDF parser:</p>\n<div class=\"codehilite\"><pre><span></span><span class=\"gh\">diff -r 478352015077 servicebot_description/urdf/servicebot.urdf</span>\n<span class=\"gd\">--- a/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:09:47 2018 -0800</span>\n<span class=\"gi\">+++ b/servicebot_description/urdf/servicebot.urdf   Wed Feb 21 18:35:09 2018 -0800</span>\n<span class=\"gu\">@@ -865,13 +852,21 @@</span>\n     &lt;/sensor&gt;\n   &lt;/gazebo&gt;\n\n<span class=\"gi\">+  &lt;gazebo reference=&quot;base_link&quot;&gt;</span>\n<span class=\"gi\">+    &lt;collision name=&quot;inflation&quot;&gt;</span>\n<span class=\"gi\">+      &lt;geometry&gt;</span>\n<span class=\"gi\">+        &lt;cylinder&gt;</span>\n<span class=\"gi\">+          &lt;radius&gt;0.5&lt;/radius&gt;</span>\n<span class=\"gi\">+          &lt;length&gt;1.0&lt;/length&gt;</span>\n<span class=\"gi\">+        &lt;/cylinder&gt;</span>\n<span class=\"gi\">+      &lt;/geometry&gt;</span>\n<span class=\"gi\">+      &lt;surface&gt;</span>\n<span class=\"gi\">+        &lt;contact&gt;</span>\n<span class=\"gi\">+          &lt;collide_without_contact&gt;true&lt;/collide_without_contact&gt;</span>\n<span class=\"gi\">+        &lt;/contact&gt;</span>\n<span class=\"gi\">+      &lt;/surface&gt;</span>\n<span class=\"gi\">+    &lt;/collision&gt;</span>\n   &lt;/gazebo&gt;\n<span class=\"gd\">-</span>\n   &lt;gazebo reference=&quot;base_link&quot;&gt;\n     &lt;mu1&gt;0.5&lt;/mu1&gt;\n</pre></div>\n\n\n<p>with this backtrace:</p>\n<div class=\"codehilite\"><pre><span></span>#0  0x00007ffff457f6ed in InsertSDFExtensionCollision (_elem=0x7ffec8a2b5a0, _linkName=&quot;base_link&quot;)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:1904\n#1  0x00007ffff459bca0 in CreateCollision (_elem=0x7ffec89d2f40, _link=..., _collision=..., _oldLinkName=&quot;base_link_collision&quot;)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3408\n#2  0x00007ffff4594b7d in CreateCollisions (_elem=0x7ffec89d2f40, _link=...) at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3038\n#3  0x00007ffff4593d89 in CreateLink (_root=0x7ffec89d56d0, _link=..., _currentTransform=...)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2908\n#4  0x00007ffff459287c in CreateSDF (_root=0x7ffec89d56d0, _link=..., _transform=...)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:2842\n#5  0x00007ffff459da2e in sdf::URDF2SDF::InitModelString (this=0x7ffedb7fc24f, \n    _urdfStr=&quot;&lt;robot name=\\&quot;servicebot\\&quot;&gt;&lt;!-- Note: this doesnt follow REP 120 as this robot, while having a humanoid shape, will behave like a mobile base --&gt;&lt;!-- setting the base_link as the center of mass of the t&quot;..., _enforceLimits=true)\n    at /media/louise/TERA/code/sdf5/src/parser_urdf.cc:3523\n</pre></div>", "type": "rendered"}, "source": {"commit": {"hash": "9890bbe1b9e3", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/servicesim/commit/9890bbe1b9e3.json"}, "html": {"href": "#!/osrf/servicesim/commits/9890bbe1b9e3"}}}, "repository": {"links": {"self": {"href": "data/repositories/osrf/servicesim.json"}, "html": {"href": "#!/osrf/servicesim"}, "avatar": {"href": "data/bytebucket.org/ravatar/{3f537f5a-62ec-4117-968f-73e9064ad028}ts=c_plus_plus"}}, "type": "repository", "name": "servicesim", "full_name": "osrf/servicesim", "uuid": "{3f537f5a-62ec-4117-968f-73e9064ad028}"}, "branch": {"name": "approximation"}}, "comment_count": 10, "state": "MERGED", "task_count": 0, "participants": [{"role": "PARTICIPANT", "participated_on": "2018-02-22T20:47:09.271652+00:00", "type": "participant", "approved": true, "user": {"display_name": "Rohitsalem", "uuid": "{9bb649c1-db0a-48f0-9d32-bd264478ca20}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B9bb649c1-db0a-48f0-9d32-bd264478ca20%7D"}, "html": {"href": "https://bitbucket.org/%7B9bb649c1-db0a-48f0-9d32-bd264478ca20%7D/"}, "avatar": {"href": "data/secure.gravatar.com/avatar/e0f5cae362a1e9bdd2d789328b6090a0d=httpsavatar-management--avatars.us-west-2.prod.public.atl-paas.netinitialsR-3.png"}}, "nickname": "rohitsalem", "type": "user", "account_id": "557058:d6a9f34e-2c17-4df6-bb9f-2303baa1d149"}}, {"role": "PARTICIPANT", "participated_on": "2018-02-22T22:59:18.971641+00:00", "type": "participant", "approved": false, "user": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}, {"role": "PARTICIPANT", "participated_on": "2018-02-22T21:32:51.641555+00:00", "type": "participant", "approved": false, "user": {"display_name": "Ian Chen", "uuid": "{eaa6fca5-6deb-43f6-907f-971c144735dd}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D"}, "html": {"href": "https://bitbucket.org/%7Beaa6fca5-6deb-43f6-907f-971c144735dd%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5/1e4adcdf-1946-4280-9aea-eb5f15a7f912/128"}}, "nickname": "Ian Chen", "type": "user", "account_id": "557058:10b01d41-a2e9-4a41-a907-e6e2f03b6cd5"}}], "reason": "", "updated_on": "2018-02-22T23:00:14.009860+00:00", "author": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}, "merge_commit": {"hash": "20fccb347ebf", "type": "commit", "links": {"self": {"href": "data/repositories/osrf/servicesim/commit/20fccb347ebf.json"}, "html": {"href": "#!/osrf/servicesim/commits/20fccb347ebf"}}}, "closed_by": {"display_name": "Louise Poubel", "uuid": "{5cfa2075-477b-4ded-bdb9-8d2479544ec4}", "links": {"self": {"href": "https://api.bitbucket.org/2.0/users/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D"}, "html": {"href": "https://bitbucket.org/%7B5cfa2075-477b-4ded-bdb9-8d2479544ec4%7D/"}, "avatar": {"href": "https://avatar-management--avatars.us-west-2.prod.public.atl-paas.net/557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8/7d903d90-c5ea-4182-b7ef-0d467e9e1c74/128"}}, "nickname": "chapulina", "type": "user", "account_id": "557058:6ff86fcb-b7ab-44a5-b8a6-f6d9cae8b6e8"}}